基本原则

宿主中不要放业务逻辑。只做加载插件以及调起主插件的操作。

重构步骤

拆lib.* - 公共模块插件
把各个第三方库拆出来做成一个个lib.*插件模块，包括统计、地图、网络、图片等库。
把老项目积累的业务公共代码(utils)分离出来封装成一个lib.utils插件
把基础的样式、主题分离出来封装成一个lib.style插件
拆app.* - 业务模块插件
把业务模块拆成app.*模块，他们可以依赖lib.*模块，显示调用lib.*中的各个API
相对独立的业务模块先拆，比如“详情页”、“关于我们”，如果剩下的业务不好拆，先放一个插件里
如果都不好拆，先把全部业务做成一个app.main主插件

Sample示例

lib.style - 公共主题
lib.utils - 公共API、公共控件
lib.analytics - 第三方统计
app.main - 主插件
app.home - 首页
app.detail - 详情页

“宿主工程不能有任何依赖lib的动作。”